<div class="p-8 bg-gray-100 min-h-screen flex flex-col items-center">
  <div class="bg-white p-6 rounded-xl shadow-lg max-w-6xl w-full">

    <!-- En-tête -->
    <div class="flex justify-between items-center border-b pb-3 mb-4">
      <h3 class="font-semibold text-[#2388FF] text-2xl">Produits à facturer</h3>
      <button class="text-gray-500 hover:text-black">✕</button>
    </div>

    <!-- Tableau des produits sélectionnés -->
    <div class="bg-gray-50 p-4 rounded-xl shadow-sm">
      <table class="w-full border-collapse">
        <thead class="bg-gray-100 rounded-xl">
          <tr class="text-left text-gray-600 font-semibold">
            <th class="p-3">Produits</th>
            <th class="p-3">Qté</th>
            <th class="p-3">TVA</th>
            <th class="p-3">Unité</th>
            <th class="p-3">Prix HT</th>
            <th class="p-3">Prix TTC</th>
            <th class="p-3">Total</th>
            <th class="p-3 text-center">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let produitCtrl of produitsFacture.controls; let i = index" [formGroup]="getProduitFormGroup(i)"
              class="border-b">
            <td class="p-3">{{ produitCtrl.value.nom }}</td>
            <td class="p-3">
              <input type="number" formControlName="quantite" class="border rounded-lg p-2 w-16 text-center"
                     (input)="calculerTotal()" min="1">
            </td>
            <td class="p-3">
              <select formControlName="tva" class="border rounded-lg p-2 w-20 text-center" (change)="calculerTotal()">
                <option *ngFor="let taux of tauxTVA" [value]="taux">{{ taux }}%</option>
              </select>
            </td>
            <td class="p-3">{{ produitCtrl.value.unite || 'N/A' }}</td>
            <td class="p-3">{{ produitCtrl.value.prixHT }} €</td>
            <td class="p-3">{{ produitCtrl.value.prixTTC }} €</td>
            <td class="p-3">{{ produitCtrl.value.total }} €</td>
            <td class="p-3 text-center">
              <button (click)="supprimerProduit(i)" class="bg-red-500 text-white p-2 rounded-lg hover:bg-red-600">
                Supprimer
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Bouton Ajouter une ligne -->
    <div class="flex justify-start mt-6">
      <button (click)="ajouterProduit($event)" class="bg-[#2388FF] text-white font-semibold px-6 py-3 rounded-lg 
              shadow-md hover:bg-[#1A6ED8] transition">
        AJOUTER UNE LIGNE
      </button>
    </div>

    <!-- Formulaire de sélection -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-6">
      <div class="border rounded-lg p-3 text-gray-600">
        <label class="text-sm">Sélectionner un produit</label>
        <select (change)="ajouterProduit($event)" class="w-full border-0 bg-transparent">
          <option value="" disabled selected>Choisir...</option>
          <option *ngFor="let produit of produits" [value]="produit.id">
            {{ produit.nom }}
          </option>
        </select>
      </div>
      <div class="border rounded-lg p-3 text-gray-600">
        <label class="text-sm">Quantité</label>
        <p class="text-lg font-semibold">3</p>
      </div>
      <div class="border rounded-lg p-3 text-gray-600">
        <label class="text-sm">TVA</label>
        <p class="text-lg font-semibold">20%</p>
      </div>
      <div class="border rounded-lg p-3 text-gray-600">
        <label class="text-sm">Unité</label>
        <p class="text-lg font-semibold">Jours</p>
      </div>
      <div class="border rounded-lg p-3 text-gray-600">
        <label class="text-sm">Prix HT</label>
        <p class="text-lg font-semibold">125 €</p>
      </div>
      <div class="border rounded-lg p-3 text-gray-600">
        <label class="text-sm">Prix TTC</label>
        <p class="text-lg font-semibold">150 €</p>
      </div>
      <div class="border rounded-lg p-3 text-gray-600">
        <label class="text-sm">Total</label>
        <p class="text-lg font-semibold">400 €</p>
      </div>
    </div>

<!-- Résumé des prix -->
<div class="mt-6 flex justify-end">
  <div class="p-4 bg-[#2388FF] text-white rounded-lg shadow-md w-64">
    <div class="flex justify-between">
      <p class="text-sm">Sous-total</p>
      <p class="font-semibold">€{{ sousTotal }}</p>
    </div>
    <div class="flex justify-between border-t border-white my-2 pt-2">
      <p class="text-sm">TAX</p>
      <p class="font-semibold">€{{ totalTVA }}</p>
    </div>
    <div class="flex justify-between text-lg font-bold">
      <p>Total</p>
      <p>€{{ total }}</p>
    </div>
  </div>
</div>

    <!-- Section Informations Légales & Conditions -->
<div class="mt-6 bg-white p-4 rounded-lg shadow-md border">
  <div class="flex justify-between items-center border-b pb-2">
    <h3 class="font-semibold text-gray-800">Note de bas de page | Informations légales</h3>
    <button class="text-gray-500 hover:text-black">✕</button>
  </div>
  
  <div class="mt-4">
    <label class="text-gray-600 text-sm">Commentaires</label>
    <textarea formControlName="conditions" placeholder="Ajoutez ici les conditions de paiement, mentions légales..."
              class="border border-gray-300 w-full p-3 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-200"
              rows="3"></textarea>
  </div>
</div>

<!-- Bouton Voir Aperçu -->
<div class="mt-6">
  <button class="bg-[#2388FF] text-white px-6 py-3 rounded-lg w-full text-center shadow-md">
  </button>
</div>